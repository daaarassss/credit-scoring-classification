# Прогноз дефолта клиентов банка (Credit Scoring Project)

## Описание проекта
Целью данного проекта является разработка модели машинного обучения для прогнозирования риска невыполнения кредитных обязательств. Задача сформулирована как бинарная классификация заемщиков на два класса:
* **0** — надежные заемщики (выполнение обязательств);
* **1** — дефолт (нарушение обязательств).

**Ключевой показатель эффективности (KPI):** Достижение метрики **F1-score > 0.5** на тестовой выборке.

---

## Технологический стек
* **Язык разработки:** Python
* **Библиотеки анализа данных:** `Pandas`, `NumPy`
* **Визуализация:** `Matplotlib`, `Seaborn`
* **Машинное обучение:** `Scikit-learn`
* **Алгоритмы:**
  *  Самописная логистическая регрессия (Градиентный спуск)
  * Scikit-learn Logistic Regression
  * Scikit-learn Linear Regression (LPM)

---

## Математическая модель
В рамках проекта реализован алгоритм логистической регрессии "с нуля". Для оценки вероятности принадлежности к классу дефолта используется логистическая функция (сигмоида):

$$\sigma(z) = \frac{1}{1 + e^{-z}}$$

Где $z = w^T X + b$. Оптимизация вектора весов $w$ и смещения $b$ осуществляется путем минимизации логарифмической функции потерь (Log-Loss) через итеративный градиентный спуск.



---

## Этапы реализации проекта

### 1. Разведывательный анализ данных (EDA)
* **Анализ целевой переменной:** Выявлен дисбаланс классов (соотношение ~72/28 в пользу мажоритарного класса).
* **Обработка аномалий:**
  * Проведена коррекция признака `Credit Score` (значения > 850 приведены к стандартной шкале путем деления на 10).
  * Идентифицированы технические заглушки в признаке `Current Loan Amount` (99,999,999), на основе которых создан информативный бинарный признак.

### 2. Feature Engineering (Инженерия признаков)
* **DataTransformer:** Создан кастомный класс для обеспечения воспроизводимости предобработки (Pipeline).
* **Сгенерированные признаки:**
    * `DTI` (Debt-to-Income) — индикатор долговой нагрузки.
    * `Negative_Records` — агрегированный показатель кредитных проблем (банкротства, залоги).
    * Порядковое кодирование стажа работы и One-Hot Encoding для категориальных признаков.

### 3. Настройка классификатора
Для достижения целевого качества при наличии дисбаланса классов применен метод **Threshold Tuning**. Оптимальный порог классификации смещен до уровня **0.35**, что позволило сбалансировать точность (Precision) и полноту (Recall).

---

## Результаты сравнения моделей

| Алгоритм | F1-Score | Особенности |
| :--- | :--- | :--- |
| **MyLogisticRegression (Custom)** | **0.5049** | **Итоговое решение** |
| LogisticRegression (Sklearn) | 0.4996 | Baseline с `class_weight='balanced'` |
| LinearRegression (Sklearn) | 0.4899 | Линейная аппроксимация вероятности |

---

## Структура репозитория
* `course_project_train.csv` — обучающая выборка.
* `course_project_test.csv` — тестовая выборка для предсказаний.
* `HW_regression.ipynb` — Jupyter Notebook с полным кодом исследования.
* `predictions.csv` — итоговый файл прогнозов.

---

## Резюме
Использование кастомной реализации логистической регрессии позволило обеспечить гибкую настройку модели под специфику банковских данных. Ключевым фактором достижения F1 > 0.5 стала глубокая предобработка аномалий и оптимизация порога принятия решения.

---
**Автор:** Огнева Дарья  
**Дата:** 2026
